10 GOSUB 6560
20 LO=0:GOSUB 6680:GOSUB 6720:PRINT " Executive Calendar - Version 02.00.00 ";
30 LO=96:GOSUB 6680:GOSUB 6720:PRINT "Dates";
40 LO=165:GOSUB 6680:GOSUB 6720:PRINT "Copyright 1983 by Tandy Corp.";
50 LO=250:GOSUB 6680:GOSUB 6720:PRINT "All rights reserved";
60 DIM MN$(12),DY$(6),HL$(20,5),EA(19)
70 FOR X=1 TO 12:READ MN$(X):NEXT X
80 FOR X=0 TO 6:READ DY$(X):NEXT X
90 FOR X=1 TO 18:FOR Y=1 TO 5:READ HL$(X,Y):NEXT Y,X
100 FOR X=1 TO 19:READ EA(X):NEXT X
110 GOTO 480
130 REM Display main menu
140 GOSUB 6560
150 LO=0:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT "         TRS-80 MODEL 100 DATES         ";:GOSUB 6820
160 LO=53:GOSUB 6680:GOSUB 6720:PRINT "1. Conversions";
170 LO=93:GOSUB 6680:GOSUB 6720:PRINT "2. Holidays";
180 LO=133:GOSUB 6680:GOSUB 6720:PRINT "3. Weekdays";
190 LO=173:GOSUB 6680:GOSUB 6720:PRINT "8. Menu";
200 LO=280:GOSUB 6680:GOSUB 6720:PRINT "          Press option number          ";
210 RETURN
230 REM Clear display 1
240 FOR Z9=1 TO 5
250 LO=(Z9*40)+1:GOSUB 6680:GOSUB 6720:PRINT "                                      ";
260 NEXT Z9
270 RETURN
290 REM Clear display 2
300 FOR Z9=1 TO 2
310 LO=(Z9*40)+201:GOSUB 6680:GOSUB 6720:PRINT "                                      ";
320 NEXT Z9
330 RETURN
350 REM Enter on Screen(K$)
360 K=K+INT((40-LEN(K$))/2)
370 LO=K:GOSUB 6680:GOSUB 6720:PRINT K$;
380 RETURN
400 REM Press enter to continue
410 LO=280:GOSUB 6680:GOSUB 6720:PRINT "         Press ENTER to return         ";
430 K$=INKEY$:IF K$="" THEN 430
440 IF K$=CHR$(13) THEN RETURN
450 GOTO 430
470 REM Main Menu
480 GOSUB 140
490 REM Main Menu Input
500 K$=INKEY$:IF K$="" THEN 500
510 IF K$="1" THEN GOSUB 4540:GOTO 500
520 IF K$="2" THEN GOSUB 1040:GOTO 500
530 IF K$="3" THEN GOSUB 2350:GOTO 500
540 IF K$="8" THEN GOSUB 600:GOTO 500
550 IF K8=2 THEN END
560 IF K8=1 THEN K8=0:GOTO 480
570 GOTO 500
590 REM End Program
600 GOSUB 6820
610 GOSUB 6560
620 K8=2
630 RETURN
650 REM Display Holidays Header
660 GOSUB 6560
670 LO=0:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT "                Holidays                ";:GOSUB 6820
680 GOSUB 730
690 GOSUB 830
700 RETURN
720 REM Display Holidays
730 S1=0
740 FOR S2=1 TO 18 STEP 4
750 S1=S1+1:S3=0
760 FOR S4=S2 TO S2+3
770 LO=(S1*40)+1+(S3*10):GOSUB 6680:GOSUB 6720:PRINT HL$(S4,1);
780 S3=S3+1
790 NEXT S4,S2
800 RETURN
820 REM Display Holidays Menu
830 LO=280:GOSUB 6680:GOSUB 6720:PRINT "1) Any Year  2) Find  8) Date Menu"
840 PRINT "U) Up  D) Down  R) Right L) Left";
850 RETURN
870 REM Display weekdays menu
880 GOSUB 6560
890 LO=0:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT "                Weekdays                ";:GOSUB 6820
900 LO=82:GOSUB 6680:GOSUB 6720:PRINT "1. Days between   5. Year given Day";
910 LO=122:GOSUB 6680:GOSUB 6720:PRINT "2. Wkdays between 6. Date given Day"
920 LO=162:GOSUB 6680:GOSUB 6720:PRINT "3. # of times     8. Date Menu";
930 LO=202:GOSUB 6680:GOSUB 6720:PRINT "4. Nth Occurrence";
940 LO=280:GOSUB 6680:GOSUB 6720:PRINT "          Press option number          ";
950 RETURN
970 REM Display conversions menu
980 GOSUB 6560
990 LO=0:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT "              Conversions               ";:GOSUB 6820
1000 LO=280:GOSUB 6680:GOSUB 6720:PRINT "1)Gregorian   2) Julian  3) Day of Yr    8) Date Menu";
1010 RETURN
1030 REM Holidays Option
1040 N1=0
1050 GOSUB 660
1060 P1=1:P2=1:N=1:P3=(P1*40)+1+((P2-1)*10)
1070 REM Holikdays input
1080 LO=P3:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT HL$(N,1);:GOSUB 6820
1090 IF K8=1 THEN RETURN
1110 K$=INKEY$:IF K$="" THEN 1110
1120 IF K$="8" THEN K8=1:RETURN
1130 IF K$="1" THEN 1490
1140 IF K$="2" THEN 1570
1150 IF INSTR("UDRLudrl",K$)=0 THEN 1180
1160 GOTO 1110
1170 REM Holidays change holiday
1180 LO=P3:GOSUB 6680:GOSUB 6720:PRINT HL$(N,1);
1190 IF K$="L" OR K$="l" THEN P2=P2-1:N=N-1
1200 IF K$="R" OR K$="r" THEN P2=P2+1:N=N+1
1210 IF K$="U" OR K$="u" THEN P1=P1-1:N=N-4
1220 IF K$="D" OR K$="d" THEN P1=P1+1:N=N+4
1230 IF P1<1 THEN P1=1:N=N+4
1240 IF P2<1 THEN P2=1:N=N+1
1250 IF (P1>4 AND P2>2) OR P1>5 THEN P1=P1-1:N=N-4
1260 IF P2>4 THEN P2=4:N=N-1
1270 P3=(P1*40)+1+((P2-1)*10)
1280 LO=P3:GOSUB 6680:GOSUB 6720:GOSUB 6600:PRINT HL$(N,1);:GOSUB 6820
1290 GOTO 1110
1320 F=0
1330 A=VAL(HL$(N,2)): REM A=0 - holiday is Easter based
1340 E=VAL(HL$(N,3)): REM Days before Easter, or multiplier to get date
1350 IF E<3 THEN F=-1
1360 ON A+1 GOSUB 1860,2060
1370 IF N2=1 THEN 1660
1380 GOSUB 2160
1390 GOSUB 2260
1400 IF N1=18 THEN N=N+1:IF N<18 AND K$=CHR$(13) THEN 1320
1410 IF N1=18 THEN N=18
1420 REM Holiday Reset menu
1430 GOSUB 240
1440 GOSUB 830
1450 GOSUB 730
1460 GOTO 1080
1480 REM Holidays display date
1490 N2=0
1500 LO=280:GOSUB 6680:GOSUB 6720:PRINT "                                       ";
1510 LO=290:GOSUB 6680:GOSUB 6720:PRINT "Which ";
1520 Q1=296:GOSUB 5560
1530 IF N=18 THEN N1=18:N=1
1540 GOTO 1320
1560 REM Holidays Find
1570 N2=1
1580 GOSUB 240
1590 K=80:K$="Find "+HL$(N,4)+" ("+HL$(N,1)+")"
1600 GOSUB 360
1610 LO=171:GOSUB 6680:GOSUB 6720:PRINT "Date : "
1620 Q1=177:GOSUB 5040:M1=M:D1=D:Y1=Y
1630 GOTO 1320
1650 REM Holiday display year
1660 Y$=STR$(Y):Y$=RIGHT$(Y$,LEN(Y$)-1)
1670 LO=184:GOSUB 6680:GOSUB 6720:PRINT Y$;
1680 IF(Y-Y1)>200 THEN 1750
1690 IF D<>D1 OR C<>M1 THEN Y=Y+1:GOTO 1320
1700 GOSUB 2160
1710 GOSUB 2260
1720 GOTO 1430
1740 REM Holiday Invalid request
1750 GOSUB 240
1760 K=80:K$=HL$(N,4)+" does not fall on"
1770 GOSUB 360
1780 GOSUB 6640
1790 D=D1:M=M1:Y=Y1:GOSUB 6020
1800 K=160:K$=LEFT$(S1$,5)
1810 GOSUB 360
1820 GOSUB 2260
1830 GOTO 1430
1850 REM Find Easter holiday
1860 A=EA(Y-19*INT(Y/19)+1)
1870 C=INT(A)
1880 D=INT(100*(A-C))
1890 A=INT(365.25*Y)+INT(30.6001*C)+D+1720983
1900 F=A-7*INT(A/7)
1910 A=A+6-F
1920 A=A+E
1930 F=A+68569
1940 E=INT(4*F/146097)
1950 F=-INT((146097*E+3)/4)+F
1960 Y=INT(4000*(F+1)/1461001)
1970 F=-INT(1461*Y/4)+31+F
1980 C=INT(80*F/2447)
1990 D=-INT(2447*C/80)+F
2000 F=INT(C/11)
2010 C=-12*F+2+C
2020 Y=100*(E-49)+Y+F
2030 RETURN
2050 REM Find non-Easter holiday
2060 C=INT(E)
2070 E=100*(E-C)
2080 D=INT(E)
2090 E=INT(10*(E-D))
2100 F=F+Y
2110 E=E+INT(1.25*F)-INT(.75*(1+INT(F/100)))
2120 D=D-E+7*INT(E/7)
2130 RETURN
2150 REM Holiday display results
2160 GOSUB 240
2170 GOSUB 6640
2180 K=80:K$=HL$(N,4)+" ("+HL$(N,1)+")"
2190 GOSUB 360
2200 Z=D:GOSUB 6120
2210 K=120:K$=DY$(VAL(HL$(N,5)))+", "+MN$(C)+" "+R$+","+STR$(Y)
2220 GOSUB 360
2230 RETURN
2250 REM Press enter to return
2260 K=200:K$="Press ENTER to return."
2270 GOSUB 360
2290 K$=INKEY$:IF K$="" THEN 2290
2300 IF K$=CHR$(13) OR K$=CHR$(27) THEN RETURN
2310 IF K$="8" THEN K8=1:RETURN
2320 GOTO 2290
2340 REM Weekdays option
2350 GOSUB 880
2360 REM Weekdays menu input
2370 K$=INKEY$:IF K$="" THEN 2370
2380 K=ASC(K$):IF K=255 OR K=254 THEN K8=1:RETURN
2390 IF K>247 THEN ON K-247 GOSUB 2430,2620,3060,3170,3630,4080
2400 GOTO 2370
2420 REM Days between dates
2430 GOSUB 240
2440 GOSUB 300
2450 K=40:K$="# of Days between two dates"
2460 GOSUB 360
2470 LO=127:GOSUB 6680:GOSUB 6720:PRINT "Start Date : ";
2480 Q1=139:GOSUB 5040
2490 M1=M:D1=D:Y1=Y
2500 GOSUB 5820:W=I
2510 LO=167:GOSUB 6680:GOSUB 6720:PRINT "End Date  : ";
2520 Q1=179:GOSUB 5040:M1=M:D1=D:Y1=Y
2530 GOSUB 5820:W=I-W
2540 K=200:K$=STR$(W)+" days"
2550 GOSUB 360
2560 GOSUB 6640
2570 GOSUB 410
2580 GOSUB 880
2590 RETURN
2610 REM Weekdays between dates
2620 GOSUB 240
2630 GOSUB 300
2640 K=40:K$="# of Weekdays between two dates"
2650 GOSUB 360
2660 B=2
2670 C$="Weekdays"
2680 GOSUB 2730
2690 GOSUB 880
2700 RETURN
2720 REM Input start and end dates
2730 LO=129:GOSUB 6680:GOSUB 6720:PRINT "Start Date : ";
2740 Q1=141:GOSUB 5040
2750 M1=M:I=D-2:Y1=Y
2760 GOSUB 2910
2770 ON B GOSUB 2970,3020
2780 A=N
2790 LO=169:GOSUB 6680:GOSUB 6720:PRINT "End Date   : ";
2800 Q1=181:GOSUB 5040
2810 M1=M:I=D:Y1=Y
2820 GOSUB 2910
2830 ON B GOSUB 2970,3020
2840 N=N-A
2850 IF B<>1 THEN K$=STR$(N-1)+" "+C$ ELSE K$=STR$(N)+" "+C$
2860 K=200:GOSUB 360
2870 GOSUB 410
2880 RETURN
2900 REM Conver to day of year
2910 IF M1<3 THEN M1=M1+12:Y1=Y1-1
2920 M1=M1+1
2930 I=I-INT(.75*(INT(.01*Y1)-7))+INT(365.25*Y)+INT(30.6*M1)
2940 RETURN
2960 REM Calc days between dates
2970 I=I-W
2980 N=INT(I/7)+INT(.055*(I-7*INT(I/7))+1.4)
2990 RETURN
3010 REM Calc weekdays between dates
3020 N=5*INT(I/7)+INT(.9005*(I-7*INT(I/7))+.5)
3030 RETURN
3050 REM Weekdays Number Times
3060 GOSUB 240
3070 GOSUB 300
3080 K=40:K$="# of times Given day occurs"
3090 GOSUB 360
3100 B=1:C$="times"
3110 Q1=89:GOSUB 5740
3120 GOSUB 2730
3130 GOSUB 880
3140 RETURN
3160 REM Weekdays N Occurance In Month
3170 GOSUB 240
3180 GOSUB 300
3190 K=40:K$="Nth Occurence of Day in month"
3200 GOSUB 360
3210 Q1=91:GOSUB 5740
3220 Q1=133:GOSUB 5460
3240 K=160:K$="Which "+DY$(W)+" in "+MN$(M)+","+STR$(Y)+" : "
3260 GOSUB 360
3270 LINE INPUT N$:N=VAL(N$)
3280 IF N<1 OR N>5 THEN 3240
3290 A=M:B=Y
3300 IF A<3 THEN A=A+12:B=B-1
3310 A=A+1
3320 H=W-INT(2.6*A)-INT(1.25*B)+INT(.75*INT(.01*B-7))
3330 H=H-7*INT(H/7)
3340 H=H+(H=0)*-7
3350 D=H+7*N-7
3360 IF D<29 THEN 3550
3370 IF (M=4 OR M=9 OR M=6 OR M=11) AND D<31 THEN 3550
3380 IF (M=1 OR M=3 OR M=5 OR M=7 OR M=8 OR M=10 OR M=12) AND D<32 THEN 3550
3390 IF M<>2 THEN 3470
3400 IF D>29 THEN 3470
3410 Y$=STR$(Y)
3420 M1=VAL(RIGHT$(Y$,2))
3430 IF M1=0 THEN M3=Y/400-INT(Y/400):IF M3=0 THEN 3470
3440 M3=M1/4-INT(M1/4)
3450 IF M3=0 THEN 3550
3460 REM Weekdays Invalid Request
3470 GOSUB 6640:GOSUB 6640
3480 K=200:K$="There aren't"+STR$(N)+" "+DY$(W)+"s in "+MN$(M)
3490 GOSUB 360
3500 GOSUB 410
3510 GOSUB 880
3520 RETURN
3540 REM Display Day Of Month
3550 Z=D:GOSUB 6120
3560 K=200:K$="It's on the "+R$
3570 GOSUB 360
3580 GOSUB 410
3590 GOSUB 880
3600 RETURN
3620 REM Weekdays year given day
3630 GOSUB 240
3640 GOSUB 300
3650 K=40:K$="Given Date occurs on given day"
3660 GOSUB 360
3670 Q1=91:GOSUB 5740
3680 LO=127:GOSUB 6680:GOSUB 6720:PRINT "Start date :";
3690 Q1=139:GOSUB 5040
3700 A=M:F=0:F1=1
3710 GOSUB 3770
3720 GOSUB 410
3730 GOSUB 880
3740 RETURN
3760 REM Calculate year given day
3770 IF 3>M THEN F=1:M=M+12
3780 Z=INT((M+11)*2.6)+D
3790 Z=(Z-W-INT((Z-W)/7)*7)/2
3800 X=INT(Z)
3810 IF X<>Z THEN X=X+4
3820 X=INT((Y-1-(4*X))/28)*28+(4*X)+F
3830 F=1:GOSUB 240
3840 Z=D:GOSUB 6120
3850 K=40:K$=DY$(W)+" will be on "+MN$(A)+" "+R$+" in"
3860 GOSUB 360
3880 GOSUB 3950:X=X+6:IF F=>13 THEN RETURN
3890 GOSUB 3950:X=X+11:IF F=>13 THEN RETURN
3900 GOSUB 3950:X=X+6:IF F>=13 THEN RETURN
3910 GOSUB 3950:X=X+5:IF F<12 THEN 3880
3920 RETURN
3950 IF X>=Y THEN IF(A*D<>58)OR(X/4=INT(X/4))THEN GOSUB 3990:F=F+1
3960 RETURN
3990 IF F<4 THEN F1=(F*40)+86
4000 IF F>3 AND F<7 THEN F1=((F-3)*40)+93
4010 IF F>6 AND F<10 THEN F1=((F-6)*40)+100
4020 IF F>9 THEN F1=((F-9)*40)+107
4030 GOSUB 6640
4040 LO=F1:GOSUB 6680:GOSUB 6720:PRINT STR$(X);
4050 RETURN
4070 REM Weekdays date given day
4080 GOSUB 240
4090 K=40:K$="Dates of given day of the week"
4100 GOSUB 360
4110 Q1=89:GOSUB 5740
4120 LO=128:GOSUB 6680:GOSUB 6720:PRINT "Start Date : ";
4130 Q1=138:GOSUB 5040
4140 GOSUB 240
4150 K=40:K$=DY$(W)+" falls on "
4160 GOSUB 360
4170 GOSUB 4230
4180 GOSUB 410
4190 GOSUB 880
4200 RETURN
4220 REM Calculate date given day
4230 IF M<3 THEN M=M+12:Y=Y-1
4240 M=M+1
4250 J=INT(365.25*Y)+INT(30.6001*M)+D+1720982
4260 Z=J+1-7*INT((J+1)/7)
4270 IF Z>W THEN W=W+7
4280 J=J+W-Z
4290 A=0
4300 13630:
4310 R=J+68569
4320 P=INT(4*R/146097)
4330 R=-INT(((146097*P)+3)/4)+R
4340 Y=INT(4000*(R+1)/1461001)
4350 R=-INT((1461*Y)/4)+31+R
4360 M=INT(80*R/2447)
4370 S=-INT(2447*M/80)+R
4380 R=INT(M/11)
4390 M=(-12*R)+2+M
4400 Y=100*(P-49)+Y+R
4410 A=A+1
4420 D=S
4430 GOSUB 6020
4440 IF A<4 THEN A1=(A*40)+82
4450 IF A>3 AND A<7 THEN A1=((A-3)*40)+95
4460 IF A>6 THEN A1=((A-6)*40)+107
4470 LO=A1:GOSUB 6680:GOSUB 6720:PRINT S1$;
4480 GOSUB 6640
4490 J=J+7
4500 IF A<9 THEN 13630
4510 RETURN
4530 REM Conversion Option
4540 GOSUB 980
4550 REM Conversion-Input
4560 K$=INKEY$:IF K$="" THEN 4560
4570 IF K$="8" THEN GOTO K8=1:RETURN
4580 IF K$="1" THEN GOTO 4640
4590 IF K$="2" THEN GOTO 4710
4600 IF K$="3" THEN GOTO 4780
4610 GOTO 4560
4630 REM Conversion - Gregorian
4640 GOSUB 240
4650 LO=131:GOSUB 6680:GOSUB 6720:PRINT "Date :";
4660 Q1=137:GOSUB 5040
4670 M1=M:D1=D:Y1=Y:GOSUB 5820
4680 J=I:GOTO 4840
4700 REM Conversion - Julian
4710 GOSUB 240
4720 LO=131:GOSUB 6680:GOSUB 6720:PRINT "Date :";
4730 LINE INPUT J$:J=VAL(J$)
4740 GOSUB 5890
4750 GOTO 4840
4770 REM Conversion-Day of Year
4780 GOSUB 240
4790 Q1=131:GOSUB 5270
4800 J=INT(365.25*Y)+D+1721045
4810 GOSUB 5890
4830 REM Conversion Display Result
4840 M1=12:D1=31:Y1=Y-1
4850 GOSUB 5820
4860 Z=J-I:M1=12:D1=31:Y1=Y
4870 GOSUB 5820
4880 W=I-J:D2=J+1-7*INT((J+1)/7)
4890 GOSUB 240
4900 GOSUB 6020
4910 K=80:K$=DY$(D2)+", "+S1$
4920 GOSUB 360
4930 GOSUB 6230
4940 K=120:K$=J$+" Julian Days"
4950 GOSUB 360
4960 GOSUB 6120
4970 K=159:K$=R$+" day of the year"
4980 GOSUB 360
4990 K=200:K$=STR$(W)+" remain in the year"
5000 GOSUB 360
5010 GOTO 4560
5030 REM Input Date(Q1 - screen location for prompt)=> M,D,Y
5040 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT " MM/DD/YYYY";
5050 GOSUB 6640
5060 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT " ";
5070 LINE INPUT Y$
5080 IF LEN(Y$)<>10 THEN 5040
5090 IF MID$(Y$,3,1)<>"/" OR MID$(Y$,6,1)<>"/" THEN 5040
5100 M=VAL(LEFT$(Y$,2))
5110 D=VAL(MID$(Y$,4,2))
5120 Y=VAL(RIGHT$(Y$,4))
5130 IF M<1 OR M>12 OR D<1 THEN 5040
5140 IF M=2 AND D>29 THEN 5040
5150 IF(M=4 OR M=6 OR M=9 OR M=11) AND D>30 THEN 5040
5160 IF D>31 THEN 5040
5170 IF M=2 AND D=29 THEN 5200
5180 RETURN
5190 REM Leap Year
5200 M1=VAL(RIGHT$(Y$,2))
5210 IF M1=0 THEN M3=Y/400-INT(Y/400):IF M3<>0 THEN 5040
5220 M3=M1/4-INT(M1/4)
5230 IF M3=0 THEN RETURN
5240 GOTO 5040
5250 REM Input Day Year() => D,Y
5270 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT "Date : DDD/YYYY";
5280 GOSUB 6640
5290 Q1=Q1+6
5310 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT " ";
5320 LINE INPUT Y$
5330 IF LEN(Y$)<>8 THEN 5310
5340 IF MID$(Y$,4,1)<>"/" THEN 5310
5350 D=VAL(LEFT$(Y$,3))
5360 Y=VAL(RIGHT$(Y$,4))
5370 IF D<1 OR Y<1 OR D>366 THEN 5310
5380 IF D<>366 THEN RETURN
5390 M1=VAL(RIGHT$(Y$,2))
5400 IF M1=0 THEN M3=Y/400-INT(Y/400):IF M3=0 THEN 5310
5410 M3=M1/4-INT(M1/4)
5420 IF M3=0 THEN RETURN
5430 GOTO 5310
5440 REM Input Month Year()=>M,Y
5460 GOSUB 6640
5470 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT "Date : MM/YYYY";
5480 LO=Q1+6:GOSUB 6680:GOSUB 6720:PRINT " ";
5490 LINE INPUT Y$
5500 IF LEN(Y$)<>7 THEN 5460
5510 M=VAL(LEFT$(Y$,2)):Y=VAL(RIGHT$(Y$,4))
5520 IF M<1 OR M>12 OR Y<1 THEN 5460
5530 RETURN
5540 REM Input Year() => Y
5560 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT "Year : YYYY";
5570 GOSUB 6640
5580 LO=302:GOSUB 6680:GOSUB 6720:PRINT " ";
5590 Y$=" ":Y1$="":Y1=1
5610 Y1$=INKEY$:IF Y1$="" THEN 5610
5620 IF (Y1$=CHR$(8) OR Y1$=CHR$(29)) AND Y1<>1 THEN Y$=LEFT$(Y$,LEN(Y$)-1):Y1=Y1-1:GOTO 5670
5630 IF INSTR("0123456789"+CHR$(13),Y1$)=0 THEN 5610
5640 IF Y1$=CHR$(13) THEN LO=302:GOSUB 6680:GOSUB 6720:PRINT Y$;"    ";:GOTO 5700
5650 Y$=Y$+Y1$:Y1=Y1+1
5670 LO=302:GOSUB 6680:GOSUB 6720:PRINT Y$;
5680 IF Y1<5 THEN 5610
5700 Y=VAL(Y$)
5710 RETURN
5720 REM Input day of week() => W
5740 GOSUB 6640
5750 LO=Q1:GOSUB 6680:GOSUB 6720:PRINT "Which Day (1-7) :";
5760 LINE INPUT W$:W=VAL(W$):W=W-1
5770 IF W<0 OR W>6 THEN 5740
5780 RETURN
5810 REM gregorian to julian M,D,Y to I
5820 IF M1<3 THEN M1=M1+12:Y1=Y1-1
5830 M1=M1+1
5840 I=INT(365.25*Y1)+INT(30.6001*M1)+D1+1720982
5850 RETURN
5880 REM julian to gregorian conversion
5890 U=J+68569
5900 V=INT(4*U/146097)
5910 U=-INT((146097*V+3)/4)+U
5920 Y=INT(4000*(U+1)/1461001)
5930 U=-INT(1461*Y/4)+31+U
5940 M=INT(80*U/2447)
5950 D=-INT(2447*M/80)+U
5960 U=INT(M/11)
5970 M=-12*U+2+M
5980 Y=100*(V-49)+Y+U
5990 RETURN
6000 REM Format Date (M,D,Y)=>S1$
6020 M$=STR$(M):M$=RIGHT$(M$,LEN(M$)-1)
6030 IF M<10 THEN M$="0"+M$
6040 D$=STR$(D):D$=RIGHT$(D$,LEN(D$)-1)
6050 IF D<10 THEN D$="0"+D$
6060 Y$=STR$(Y):Y$=RIGHT$(Y$,LEN(Y$)-1)
6070 IF Y<0 THEN Y$=Y$+"BC"
6080 S1$=M$+"/"+D$+"/"+Y$
6090 RETURN
6100 REM Format day of month(Z)=>R$
6120 Z$=STR$(Z):G$=RIGHT$(Z$,1)
6130 IF INSTR("0456789",G$)>0 THEN R$=Z$+"th":RETURN
6140 G1=0
6150 IF Z>9 AND MID$(Z$,LEN(Z$)-1,1)="1" THEN G1=1
6160 IF G$="1" AND G1=0 THEN R$=Z$+"st":RETURN
6170 IF G$="2" AND G1=0 THEN R$=Z$+"nd":RETURN
6180 IF G$="3" AND G1=0 THEN R$=Z$+"rd":RETURN
6190 R$=Z$+"th"
6200 RETURN
6220 REM Format Julian Date(J)=>J$
6230 J$=STR$(J):J$=RIGHT$(J$,LEN(J$)-1)
6240 IF LEN(J$)>6 THEN J1=LEN(J$)-6:J$=LEFT$(J$,J1)+","+MID$(J$,J1+1,3)+","+RIGHT$(J$,3):RETURN
6250 IF LEN(J$)>3 THEN J1=LEN(J$)-3:J$=LEFT$(J$,J1)+","+RIGHT$(J$,3):RETURN
6260 RETURN
6280 REM Months
6290 DATA January,February,March,April,May,June,July,August,September,October,November,December
6300 REM Days of week
6310 DATA Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday
6320 REM Holidays
6330 DATA President,1,2.212,Presidents' Day,1
6340 DATA Mother's,1,5.14,Mother's Day,0
6350 DATA Memorial,1,5.312,Memorial Day,1
6360 DATA Father's,1,6.213,Father's Day,0
6370 DATA Labor,1,9.073,Labor Day,1
6380 DATA Columbus,1,10.145,Columbus Day,1
6390 DATA Election,1,11.081,Election Day,2
6400 DATA Thanksgv,1,11.285,Thanksgiving Day,4
6410 DATA Ash Wed,0,-46,Ash Wednesday,3
6420 DATA 1st Sun,0,-42,First Sunday in Lent,0
6430 DATA Passion,0,-14,Passion Sunday,0
6440 DATA Palm Sun,0,-7,Palm Sunday,0
6450 DATA Good Fri,0,-2,Good Friday,5
6460 DATA Easter,0,0,Easter Sunday,0
6470 DATA Ascensn,0,39,Ascension Day,4
6480 DATA Pentecst,0,49,Pentecost,0
6490 DATA Trinity,0,56,Trinity Sunday,0
6500 DATA List All,0,0,0,0
6510 REM Easter factors
6520 DATA 5.14,5.03,4.23,5.11,4.31,5.18,5.08,4.28,5.16,5.05,4.25,5.13,5.02,4.22,5.10,4.30,5.17,5.07,4.27
6540 REM CLEAR SCREEN
6560 PRINT CHR$(27);"[2J": RETURN
6580 REM Reverse screen
6600 PRINT CHR$(27)+"[7m";:RETURN
6620 REM Bell
6640 PRINT CHR$(7):RETURN
6660 REM Location(LO) to row(RO) col(CO)
6680 RO=INT(LO/40)+1:CO=LO-(RO-1)*40+1:RETURN
6700 REM Set cursor pos ro=row, co=col
6720 RO$=STR$(RO):RO$=RIGHT$(RO$,LEN(RO$)-1)
6730 CO$=STR$(CO):CO$=RIGHT$(CO$,LEN(CO$)-1)
6740 PRINT CHR$(27)+"["+RO$+";"+CO$+"H":RETURN
6760 REM Clear to end of line
6780 PRINT CHR$(27)+"[K";:RETURN
6800 REM RESET ATTRIBUTES
6820 X$=CHR$(27)+"[0m":PRINT X$;:RETURN
