10 DIM C(8):GOSUB 340
20 FOR G=1 TO 4:C(G)=INT(RND(1)*6)+1:NEXT
30 RO=7:CO=1:GOSUB 360:PRINT TAB(40)
40 RO=7:CO=1:GOSUB 360:GOSUB 510:PRINT "Left:";10-T;
50 INPUT "Guess";C(5),C(6),C(7),C(8)
60 O=5:P=T*20:GOSUB 250:W=0:B=0
70 FOR X=1 TO 4
80 Z=X+4
90 IF C(X)=C(Z) THEN B=B+1:GOTO 130
100 FOR Y=5 TO 8
110 G=C(Y):IF C(Y-4)<>G AND Y<>Z AND C(X)=G THEN 280
120 NEXT Y
130 NEXT X
140 GOSUB 170:T=T+1:IF B<>4 AND T=10 THEN 310
150 IF B=4 THEN 280
160 GOTO 30
170 LO=T*20+6:GOSUB 480:GOSUB 360:PRINT "";
180 IF W>0 THEN 200
190 GOTO 210
200 FOR X=1 TO W:PRINT "X";:NEXT
210 IF B>0 THEN 230
220 RETURN
230 FOR X=1 TO B:PRINT "O";:NEXT
240 RETURN
250 FOR X=O TO O+3
260 LO=P+(X-O):GOSUB 480:GOSUB 360:PRINT C(X);
270 NEXT:RETURN
280 IF B<>4 THEN W=W+1:C(Y)=0:GOTO 130
290 RO=7:CO=1:GOSUB 360:GOSUB 500:PRINT TAB(15);"You win!  ";
300 RO=10:CO=1:GOSUB 360:END
310 RO=7:CO=1:GOSUB 360:PRINT "Game over! Code was    ";
320 O=1:P=260:GOSUB 8:END
330 REM CLEAR SCREEN
340 PRINT CHR$(27);"[2J": RETURN
350 REM Set cursor pos ro=row, co=col
360 RO$=STR$(RO):RO$=RIGHT$(RO$,LEN(RO$)-1)
370 CO$=STR$(CO):CO$=RIGHT$(CO$,LEN(CO$)-1)
380 X$=CHR$(27)+"["+RO$+";"+CO$+"H"
390 PRINT X$;
400 RETURN
450 REM Bell
460 PRINT CHR$(7):RETURN
470 REM Location(LO) to row(RO) col(CO)
480 RO=INT(LO/40)+1:CO=LO-(RO-1)*40+1
490 RETURN
500 REM Clear to end of line
510 PRINT CHR$(27)+"[K";:RETURN
